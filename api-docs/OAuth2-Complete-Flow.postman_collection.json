{
    "info": {
        "name": "OAuth2 Complete Flow (Google + GitHub)",
        "description": "Complete OAuth2 flow with automatic LINK mode detection.\n\n**LOGIN Mode** (no Bearer token):\n1. POST /authorize/{PROVIDER} ‚Üí Get authorization URL\n2. Open in browser ‚Üí Authorize\n3. Callback detects LOGIN mode ‚Üí Creates/logs in user ‚Üí Returns JWT tokens\n\n**LINK Mode** (with Bearer token):\n1. POST /authorize/{PROVIDER} with Bearer token ‚Üí Get authorization URL\n2. Backend embeds userId in state: PROVIDER:uuid:LINK:userId:clientState\n3. Open in browser ‚Üí Authorize\n4. Callback detects LINK mode ‚Üí Links provider to existing user ‚Üí Returns LINK_SUCCESS\n\n**Key Changes:**\n- OAuth codes are single-use, consumed by callback\n- No manual POST /link needed (automatic in callback)\n- State format includes mode detection\n- Deprecated manual link endpoints (kept for backward compatibility)",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{accessToken}}",
                "type": "string"
            }
        ]
    },
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// Auto-set base URL if not set",
                    "if (!pm.environment.get('baseUrl')) {",
                    "    pm.environment.set('baseUrl', 'http://localhost:9085');",
                    "}"
                ]
            }
        }
    ],
    "item": [
        {
            "name": "üîµ OAuth2 Login/Signup Flow",
            "item": [
                {
                    "name": "Google - Get Authorization URL",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    const data = response.data;",
                                    "    pm.environment.set('googleAuthUrl', data.authorizationUrl);",
                                    "    pm.environment.set('googleState', data.state);",
                                    "    ",
                                    "    console.log('‚úÖ Google Auth URL:', data.authorizationUrl);",
                                    "    console.log('‚úÖ State:', data.state);",
                                    "    console.log('‚ö†Ô∏è  Open this URL in browser to login with Google');",
                                    "    console.log('‚ö†Ô∏è  After login, browser will auto-redirect and you will receive tokens');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"state\": \"{{$randomUUID}}\",\n  \"redirectUri\": \"{{googleRedirectUri}}\",\n  \"scope\": [\"openid\", \"profile\", \"email\"]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/authorize/GOOGLE",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "authorize",
                                "GOOGLE"
                            ]
                        },
                        "description": "**Generate Google OAuth authorization URL**\n\n**Required Fields:**\n- `state` (string): Random UUID for CSRF protection (auto-generated)\n- `redirectUri` (string): Callback URL after OAuth\n\n**Optional Fields:**\n- `scope` (array): OAuth scopes. Default: [\"openid\", \"profile\", \"email\"]\n\n**Response:**\n- `authorizationUrl`: URL to open in browser\n- `state`: Saved for callback verification\n- `expiresIn`: 600 seconds\n\n**How to use:**\n1. Send this request to get authorization URL\n2. Copy the `authorizationUrl` from response\n3. Open URL in browser ‚Üí Login with Google\n4. After login, browser auto-redirects to callback endpoint\n5. Backend returns tokens in browser (check browser response)\n\n**Note:** Callback is handled automatically by backend GET endpoint, not by Postman."
                    }
                },
                {
                    "name": "GitHub - Get Authorization URL",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    const data = response.data;",
                                    "    ",
                                    "    pm.environment.set('githubAuthUrl', data.authorizationUrl);",
                                    "    pm.environment.set('githubState', data.state);",
                                    "    pm.environment.set('githubStateExpiry', data.expiresIn);",
                                    "    ",
                                    "    console.log('‚úÖ GitHub Auth URL:', data.authorizationUrl);",
                                    "    console.log('‚úÖ State:', data.state);",
                                    "    console.log('‚úÖ Expires in:', data.expiresIn, 'seconds');",
                                    "    console.log('‚ö†Ô∏è  Please open the URL in browser and complete OAuth flow');",
                                    "    console.log('‚ö†Ô∏è  After authorization, copy the \"code\" parameter from callback URL');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"state\": \"{{$randomUUID}}\",\n  \"redirectUri\": \"{{githubRedirectUri}}\",\n  \"scope\": [\"read:user\", \"user:email\"]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/authorize/GITHUB",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "authorize",
                                "GITHUB"
                            ]
                        },
                        "description": "**Generate GitHub OAuth authorization URL**\n\n**Required Fields:**\n- `state` (string): Random UUID for CSRF protection (auto-generated)\n- `redirectUri` (string): Callback URL after OAuth\n\n**Optional Fields:**\n- `scope` (array): OAuth scopes. Default: [\"read:user\", \"user:email\"]\n\n**Response:**\n- `authorizationUrl`: URL to open in browser\n- `state`: Saved for callback verification\n- `expiresIn`: 600 seconds\n\n**How to use:**\n1. Send this request to get authorization URL\n2. Copy the `authorizationUrl` from response\n3. Open URL in browser ‚Üí Login with GitHub\n4. After login, browser auto-redirects to callback endpoint\n5. Backend returns tokens in browser (check browser response)\n\n**Note:** Callback is handled automatically by backend GET endpoint, not by Postman."
                    }
                }
            ]
        },
        {
            "name": "üîó Link Additional OAuth Providers",
            "item": [
                {
                    "name": "Google - Link Account (Auto via Callback)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    const data = response.data;",
                                    "    ",
                                    "    pm.environment.set('googleAuthUrl', data.authorizationUrl);",
                                    "    pm.environment.set('googleState', data.state);",
                                    "    pm.environment.set('googleStateExpiry', data.expiresIn);",
                                    "    ",
                                    "    console.log('‚úÖ Google Auth URL:', data.authorizationUrl);",
                                    "    console.log('‚úÖ State (contains userId for LINK mode):', data.state);",
                                    "    console.log('‚úÖ Expires in:', data.expiresIn, 'seconds');",
                                    "    console.log('‚ö†Ô∏è  Open URL in browser ‚Üí Authorize ‚Üí Callback will AUTO-LINK');",
                                    "    console.log('‚ö†Ô∏è  No manual link step needed! Check browser response after callback');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"state\": \"{{$randomUUID}}\",\n  \"redirectUri\": \"{{googleRedirectUri}}\",\n  \"scope\": [\"openid\", \"profile\", \"email\"]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/authorize/GOOGLE",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "authorize",
                                "GOOGLE"
                            ]
                        },
                        "description": "**Link Google Account (Automatic via Callback)**\n\n**Prerequisites:** Must be logged in (have valid accessToken in Bearer token)\n\n**How it works:**\n1. Send this request WITH Bearer token\n2. Backend detects you're authenticated ‚Üí Embeds your userId in state\n3. State format: `GOOGLE:uuid:LINK:userId:clientState`\n4. Open authorizationUrl in browser ‚Üí Authorize Google\n5. Google redirects to callback ‚Üí Backend detects LINK mode from state\n6. **Callback AUTO-LINKS** provider to your account (no manual step)\n7. Browser receives response: `{tokenType: \"LINK_SUCCESS\", userInfo: {...}}`\n\n**Required Fields:**\n- `state` (string): Random UUID for CSRF protection\n- `redirectUri` (string): Callback URL\n\n**Optional Fields:**\n- `scope` (array): OAuth scopes\n\n**Response:**\n- `authorizationUrl`: URL to open in browser\n- `state`: Contains LINK mode + userId (validated by backend)\n\n**Important Notes:**\n- ‚úÖ OAuth code is single-use, consumed by callback for linking\n- ‚úÖ No need for manual POST /link endpoint\n- ‚úÖ Callback response will NOT return new JWT tokens (you already have one)\n- ‚ùå Cannot link if Google email already used by another account"
                    }
                },
                {
                    "name": "GitHub - Link Account (Auto via Callback)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    const data = response.data;",
                                    "    ",
                                    "    pm.environment.set('githubAuthUrl', data.authorizationUrl);",
                                    "    pm.environment.set('githubState', data.state);",
                                    "    pm.environment.set('githubStateExpiry', data.expiresIn);",
                                    "    ",
                                    "    console.log('‚úÖ GitHub Auth URL:', data.authorizationUrl);",
                                    "    console.log('‚úÖ State (contains userId for LINK mode):', data.state);",
                                    "    console.log('‚úÖ Expires in:', data.expiresIn, 'seconds');",
                                    "    console.log('‚ö†Ô∏è  Open URL in browser ‚Üí Authorize ‚Üí Callback will AUTO-LINK');",
                                    "    console.log('‚ö†Ô∏è  No manual link step needed! Check browser response after callback');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"state\": \"{{$randomUUID}}\",\n  \"redirectUri\": \"{{githubRedirectUri}}\",\n  \"scope\": [\"read:user\", \"user:email\"]\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/authorize/GITHUB",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "authorize",
                                "GITHUB"
                            ]
                        },
                        "description": "**Link GitHub Account (Automatic via Callback)**\n\n**Prerequisites:** Must be logged in (have valid accessToken in Bearer token)\n\n**How it works:**\n1. Send this request WITH Bearer token\n2. Backend detects you're authenticated ‚Üí Embeds your userId in state\n3. State format: `GITHUB:uuid:LINK:userId:clientState`\n4. Open authorizationUrl in browser ‚Üí Authorize GitHub\n5. GitHub redirects to callback ‚Üí Backend detects LINK mode from state\n6. **Callback AUTO-LINKS** provider to your account (no manual step)\n7. Browser receives response: `{tokenType: \"LINK_SUCCESS\", userInfo: {...}}`\n\n**Required Fields:**\n- `state` (string): Random UUID for CSRF protection\n- `redirectUri` (string): Callback URL\n\n**Optional Fields:**\n- `scope` (array): OAuth scopes. Default: [\"read:user\", \"user:email\"]\n\n**Response:**\n- `authorizationUrl`: URL to open in browser\n- `state`: Contains LINK mode + userId (validated by backend)\n\n**Important Notes:**\n- ‚úÖ OAuth code is single-use, consumed by callback for linking\n- ‚úÖ No need for manual POST /link endpoint\n- ‚úÖ Callback response will NOT return new JWT tokens (you already have one)\n- ‚ùå Cannot link if GitHub email already used by another account"
                    }
                }
            ]
        },
        {
            "name": "Account Management",
            "item": [
                {
                    "name": "Get Linked Accounts",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    console.log('‚úÖ Linked providers:', response.linkedProviders.length);",
                                    "    console.log('‚úÖ Has password:', response.hasPassword);",
                                    "    console.log('‚úÖ Can unlink all:', response.canUnlinkAll);",
                                    "    ",
                                    "    response.linkedProviders.forEach(provider => {",
                                    "        console.log('   - ' + provider.provider + ': ' + provider.email);",
                                    "    });",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/linked-accounts",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "linked-accounts"
                            ]
                        },
                        "description": "Get all OAuth providers linked to current user"
                    }
                },
                {
                    "name": "Unlink Google Account",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 204', function () {",
                                    "    pm.response.to.have.status(204);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 204) {",
                                    "    console.log('‚úÖ Google account unlinked successfully');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/unlink/GOOGLE",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "unlink",
                                "GOOGLE"
                            ]
                        },
                        "description": "Unlink Google account from current user"
                    }
                },
                {
                    "name": "Unlink GitHub Account",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 204', function () {",
                                    "    pm.response.to.have.status(204);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 204) {",
                                    "    console.log('‚úÖ GitHub account unlinked successfully');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "DELETE",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/unlink/GITHUB",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "unlink",
                                "GITHUB"
                            ]
                        },
                        "description": "Unlink GitHub account from current user"
                    }
                }
            ]
        },
        {
            "name": "üîí OAuth User Management",
            "item": [
                {
                    "name": "Get Auth Status",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    console.log('‚úÖ User ID:', response.userId);",
                                    "    console.log('‚úÖ Username:', response.username);",
                                    "    console.log('‚úÖ Has Password:', response.hasPassword);",
                                    "    console.log('‚úÖ OAuth Providers:', response.oauthProviders);",
                                    "    console.log('‚úÖ Total Auth Methods:', response.totalAuthMethods);",
                                    "    console.log('‚úÖ Can Unlink OAuth:', response.canUnlinkOAuth);",
                                    "    console.log('üìù Message:', response.message);",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "GET",
                        "header": [],
                        "url": {
                            "raw": "{{baseUrl}}/auth/oauth/auth-status",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "oauth",
                                "auth-status"
                            ]
                        },
                        "description": "**Get user's authentication status**\n\n**Response:**\n- `hasPassword` (boolean): Whether user has set a password\n- `oauthProviders` (array): List of linked OAuth providers (GOOGLE, GITHUB)\n- `totalAuthMethods` (number): Total authentication methods available\n- `canUnlinkOAuth` (boolean): Whether user can unlink OAuth providers\n- `message` (string): Guidance message\n\n**Use cases:**\n- Check before attempting to unlink OAuth provider\n- Determine if user should set password\n- Display user's authentication options in UI"
                    }
                },
                {
                    "name": "Set Password (OAuth Users)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    console.log('‚úÖ Password set successfully');",
                                    "    console.log('‚úÖ Message:', response.message);",
                                    "    console.log('‚ö†Ô∏è  You can now login with username/password');",
                                    "    console.log('‚ö†Ô∏è  You can now safely unlink OAuth providers');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "bearer",
                            "bearer": [
                                {
                                    "key": "token",
                                    "value": "{{accessToken}}",
                                    "type": "string"
                                }
                            ]
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"newPassword\": \"{{newPassword}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/set-password",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "set-password"
                            ]
                        },
                        "description": "**Set password for OAuth-only users**\n\n**Purpose:**\nAllows users who registered via OAuth (Google/GitHub) to set a password, enabling traditional login method.\n\n**Required:**\n- Must be authenticated (Bearer token)\n- User must NOT already have a password (use `/change-password` if already has password)\n\n**Password Requirements:**\n- Minimum 8 characters\n- At least 1 uppercase letter\n- At least 1 lowercase letter\n- At least 1 number\n- At least 1 special character (@$!%*?&)\n\n**Benefits after setting password:**\n- Can login with username/password (traditional method)\n- Can unlink OAuth providers safely\n- Have backup login method if OAuth provider has issues\n\n**Error Cases:**\n- 400: User already has password (use `/change-password` instead)\n- 400: Password doesn't meet requirements"
                    }
                }
            ]
        },
        {
            "name": "Password Reset Flow",
            "item": [
                {
                    "name": "1. Request Password Reset (Send OTP)",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    console.log('‚úÖ Password reset OTP sent to:', response.email || pm.variables.get('resetEmail'));",
                                    "    console.log('‚ö†Ô∏è  Check email for OTP code');",
                                    "    console.log('‚ö†Ô∏è  OTP expires in 15 minutes');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{resetEmail}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/forgot-password",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "forgot-password"
                            ]
                        },
                        "description": "Request password reset OTP via email"
                    }
                },
                {
                    "name": "2. Verify OTP",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    pm.environment.set('resetToken', response.resetToken);",
                                    "    console.log('‚úÖ OTP verified successfully');",
                                    "    console.log('‚úÖ Reset token saved');",
                                    "    console.log('‚ö†Ô∏è  Use reset token to change password within 15 minutes');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"email\": \"{{resetEmail}}\",\n  \"otp\": \"{{resetOtp}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/verify-reset-otp",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "verify-reset-otp"
                            ]
                        },
                        "description": "Verify OTP and get reset token"
                    }
                },
                {
                    "name": "3. Reset Password",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    console.log('‚úÖ Password reset successfully');",
                                    "    console.log('‚úÖ You can now login with new password');",
                                    "    ",
                                    "    // Clear reset token",
                                    "    pm.environment.unset('resetToken');",
                                    "    pm.environment.unset('resetOtp');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"token\": \"{{resetToken}}\",\n  \"newPassword\": \"{{newPassword}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/reset-password",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "reset-password"
                            ]
                        },
                        "description": "Reset password using reset token"
                    }
                }
            ]
        },
        {
            "name": "Traditional Auth (For Testing)",
            "item": [
                {
                    "name": "Register",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 201', function () {",
                                    "    pm.response.to.have.status(201);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 201) {",
                                    "    const response = pm.response.json();",
                                    "    pm.environment.set('testUsername', pm.variables.get('testUsername'));",
                                    "    pm.environment.set('testEmail', pm.variables.get('testEmail'));",
                                    "    console.log('‚úÖ User registered:', response.username);",
                                    "    console.log('‚ö†Ô∏è  Check email for OTP verification');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"username\": \"{{testUsername}}\",\n  \"email\": \"{{testEmail}}\",\n  \"password\": \"{{testPassword}}\",\n  \"fullName\": \"Test User\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/register",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "register"
                            ]
                        },
                        "description": "Register traditional user for testing OAuth linking"
                    }
                },
                {
                    "name": "Login",
                    "event": [
                        {
                            "listen": "test",
                            "script": {
                                "exec": [
                                    "pm.test('Status code is 200', function () {",
                                    "    pm.response.to.have.status(200);",
                                    "});",
                                    "",
                                    "if (pm.response.code === 200) {",
                                    "    const response = pm.response.json();",
                                    "    pm.environment.set('accessToken', response.accessToken);",
                                    "    pm.environment.set('refreshToken', response.refreshToken);",
                                    "    console.log('‚úÖ Login successful');",
                                    "    console.log('‚úÖ Access token saved');",
                                    "}"
                                ],
                                "type": "text/javascript"
                            }
                        }
                    ],
                    "request": {
                        "auth": {
                            "type": "noauth"
                        },
                        "method": "POST",
                        "header": [
                            {
                                "key": "Content-Type",
                                "value": "application/json"
                            }
                        ],
                        "body": {
                            "mode": "raw",
                            "raw": "{\n  \"username\": \"{{testUsername}}\",\n  \"password\": \"{{testPassword}}\"\n}"
                        },
                        "url": {
                            "raw": "{{baseUrl}}/auth/login",
                            "host": [
                                "{{baseUrl}}"
                            ],
                            "path": [
                                "auth",
                                "login"
                            ]
                        },
                        "description": "Login to get JWT tokens for testing OAuth link"
                    }
                }
            ]
        }
    ],
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:9085",
            "type": "string"
        },
        {
            "key": "googleRedirectUri",
            "value": "http://localhost:9085/auth/oauth/callback/google",
            "type": "string"
        },
        {
            "key": "googleAuthCode",
            "value": "",
            "type": "string",
            "description": "Authorization code from Google callback URL (manually copy after Step 1)"
        },
        {
            "key": "githubRedirectUri",
            "value": "http://localhost:9085/auth/oauth/callback/github",
            "type": "string"
        },
        {
            "key": "githubAuthCode",
            "value": "",
            "type": "string",
            "description": "Authorization code from GitHub callback URL (manually copy after Step 1)"
        },
        {
            "key": "testUsername",
            "value": "testuser",
            "type": "string"
        },
        {
            "key": "testEmail",
            "value": "test@example.com",
            "type": "string"
        },
        {
            "key": "testPassword",
            "value": "Test@123456",
            "type": "string"
        },
        {
            "key": "resetEmail",
            "value": "test@example.com",
            "type": "string"
        },
        {
            "key": "newPassword",
            "value": "NewPass@123456",
            "type": "string"
        }
    ]
}