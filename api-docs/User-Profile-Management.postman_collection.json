{
    "info": {
        "_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
        "name": "WorkFitAI - User Profile Management (Auto Workflow)",
        "description": "Complete workflow for testing all 17 User Profile endpoints through API Gateway.\n\n**How to use:**\n1. Import this collection\n2. Click 'Run Collection' button\n3. All tests will run automatically in sequence\n4. Check test results\n\n**Workflow:**\n1. Register new user\n2. Verify OTP\n3. Login (get JWT token)\n4. Upload avatar to Cloudinary\n5. Manage notification settings\n6. Manage privacy settings\n7. Change password\n8. Manage sessions\n9. Enable/Disable 2FA\n10. Test account management\n\n**API Gateway Base URL:** http://localhost:9085",
        "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
    },
    "auth": {
        "type": "bearer",
        "bearer": [
            {
                "key": "token",
                "value": "{{accessToken}}",
                "type": "string"
            }
        ]
    },
    "variable": [
        {
            "key": "baseUrl",
            "value": "http://localhost:9085",
            "type": "string"
        },
        {
            "key": "accessToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "refreshToken",
            "value": "",
            "type": "string"
        },
        {
            "key": "username",
            "value": "profiletest_{{$randomInt}}",
            "type": "string"
        },
        {
            "key": "email",
            "value": "profiletest{{$randomInt}}@workfitai.test",
            "type": "string"
        },
        {
            "key": "password",
            "value": "TestPass123!@",
            "type": "string"
        },
        {
            "key": "newPassword",
            "value": "NewPass123!@",
            "type": "string"
        },
        {
            "key": "otp",
            "value": "",
            "type": "string"
        },
        {
            "key": "sessionId",
            "value": "",
            "type": "string"
        },
        {
            "key": "avatarUrl",
            "value": "",
            "type": "string"
        },
        {
            "key": "avatarPublicId",
            "value": "",
            "type": "string"
        },
        {
            "key": "twoFactorSecret",
            "value": "",
            "type": "string"
        }
    ],
    "item": [
        {
            "name": "1. Setup - Register User",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Registration successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.status).to.eql(\"success\");",
                            "});",
                            "",
                            "console.log(\"\u2705 Step 1: User registered successfully\");",
                            "console.log(\"\ud83d\udce7 Check Redis for OTP or logs for OTP code\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"email\": \"{{email}}\",\n  \"password\": \"{{password}}\",\n  \"fullName\": \"Profile Test User\",\n  \"phoneNumber\": \"+840912345678\",\n  \"role\": \"CANDIDATE\"\n}"
                },
                "url": "{{baseUrl}}/auth/register",
                "description": "Register a new user for testing profile management"
            }
        },
        {
            "name": "2. Setup - Input OTP (MANUAL STEP)",
            "event": [
                {
                    "listen": "prerequest",
                    "script": {
                        "exec": [
                            "// This is a placeholder step",
                            "// In real testing, you need to:",
                            "// 1. Check docker logs: docker logs notification-service",
                            "// 2. Or check Redis: docker exec -it auth-redis redis-cli",
                            "// 3. GET otp:<email>",
                            "// 4. Update collection variable 'otp' with the code",
                            "",
                            "console.log(\"\u26a0\ufe0f MANUAL STEP REQUIRED:\");",
                            "console.log(\"1. Check logs: docker logs auth-service | grep OTP\");",
                            "console.log(\"2. Or Redis: docker exec -it auth-redis redis-cli\");",
                            "console.log(\"   > KEYS *otp*\");",
                            "console.log(\"   > GET otp:\" + pm.collectionVariables.get(\"email\"));",
                            "console.log(\"3. Copy OTP and update 'otp' variable\");",
                            "console.log(\"4. For auto-run, set otp to any 6-digit number (123456) in dev mode\");"
                        ],
                        "type": "text/javascript"
                    }
                },
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "// Skip this request - it's just a reminder",
                            "pm.test(\"OTP reminder shown\", function () {",
                            "    pm.expect(true).to.be.true;",
                            "});",
                            "",
                            "// For automated testing, set a default OTP",
                            "if (!pm.collectionVariables.get(\"otp\")) {",
                            "    pm.collectionVariables.set(\"otp\", \"123456\");",
                            "    console.log(\"\u26a0\ufe0f Using default OTP: 123456 (may fail in production)\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/auth/health",
                "description": "Dummy request to remind about OTP retrieval"
            }
        },
        {
            "name": "3. Setup - Verify OTP",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"OTP verification successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.status).to.eql(\"success\");",
                            "});",
                            "",
                            "console.log(\"\u2705 Step 2: OTP verified, user activated\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"email\": \"{{email}}\",\n  \"otp\": \"{{otp}}\"\n}"
                },
                "url": "{{baseUrl}}/auth/verify-otp",
                "description": "Verify OTP to activate user account"
            }
        },
        {
            "name": "4. Setup - Login",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Login successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.data).to.have.property(\"accessToken\");",
                            "    ",
                            "    // Save tokens to collection variables",
                            "    pm.collectionVariables.set(\"accessToken\", jsonData.data.accessToken);",
                            "    pm.collectionVariables.set(\"refreshToken\", jsonData.data.refreshToken);",
                            "});",
                            "",
                            "console.log(\"\u2705 Step 3: Login successful, JWT token saved\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"usernameOrEmail\": \"{{email}}\",\n  \"password\": \"{{password}}\"\n}"
                },
                "url": "{{baseUrl}}/auth/login",
                "description": "Login to get JWT access token"
            }
        },
        {
            "name": "5. Get Current Profile",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Get profile successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.status).to.eql(\"success\");",
                            "    pm.expect(jsonData.data).to.have.property(\"username\");",
                            "    pm.expect(jsonData.data.username).to.eql(pm.collectionVariables.get(\"username\"));",
                            "});",
                            "",
                            "console.log(\"\u2705 Profile endpoint working\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/profile/me",
                "description": "Get current user profile information"
            }
        },
        {
            "name": "6. Upload Avatar (Base64 Sample)",
            "event": [
                {
                    "listen": "prerequest",
                    "script": {
                        "exec": [
                            "// For demo purposes, we'll use a small base64 test image",
                            "// In real scenario, you'd upload actual file using form-data",
                            "console.log(\"\ud83d\udcf8 Avatar upload test\");",
                            "console.log(\"Note: Using form-data with actual image file in production\");"
                        ],
                        "type": "text/javascript"
                    }
                },
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Avatar upload successful\", function () {",
                            "    // May return 400 if using base64 instead of multipart",
                            "    // This is expected - just testing the endpoint exists",
                            "    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
                            "});",
                            "",
                            "if (pm.response.code === 200) {",
                            "    var jsonData = pm.response.json();",
                            "    if (jsonData.avatarUrl) {",
                            "        pm.collectionVariables.set(\"avatarUrl\", jsonData.avatarUrl);",
                            "        pm.collectionVariables.set(\"avatarPublicId\", jsonData.publicId);",
                            "        console.log(\"\u2705 Avatar uploaded to Cloudinary\");",
                            "    }",
                            "} else {",
                            "    console.log(\"\u26a0\ufe0f Avatar upload needs actual file - endpoint tested\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "POST",
                "header": [],
                "body": {
                    "mode": "formdata",
                    "formdata": [
                        {
                            "key": "file",
                            "description": "Upload an actual image file here (JPG/PNG, max 5MB)",
                            "type": "file",
                            "src": []
                        }
                    ]
                },
                "url": "{{baseUrl}}/profile/avatar",
                "description": "Upload avatar to Cloudinary\n\n**Note:** To test properly:\n1. Select an image file in the form-data\n2. Max 5MB, formats: jpg, jpeg, png, webp"
            }
        },
        {
            "name": "7. Get Avatar",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Get avatar response\", function () {",
                            "    // May return 404 if no avatar uploaded",
                            "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                            "});",
                            "",
                            "if (pm.response.code === 200) {",
                            "    var jsonData = pm.response.json();",
                            "    console.log(\"\u2705 Avatar URL: \" + jsonData.avatarUrl);",
                            "} else {",
                            "    console.log(\"\u26a0\ufe0f No avatar found (expected if upload skipped)\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/profile/avatar",
                "description": "Get current user's avatar URL from Cloudinary"
            }
        },
        {
            "name": "8. Get Notification Settings",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Get notification settings successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property(\"emailNotifications\");",
                            "});",
                            "",
                            "console.log(\"\u2705 Notification settings retrieved\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/profile/notification-settings",
                "description": "Get user's notification preferences"
            }
        },
        {
            "name": "9. Update Notification Settings",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Update notification settings successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "console.log(\"\u2705 Notification settings updated\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "PUT",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"emailNotifications\": {\n    \"enabled\": true,\n    \"newJobMatch\": true,\n    \"applicationStatus\": true,\n    \"messages\": false,\n    \"weeklyDigest\": true,\n    \"promotions\": false\n  },\n  \"pushNotifications\": {\n    \"enabled\": true,\n    \"newJobMatch\": true,\n    \"applicationStatus\": true,\n    \"messages\": true\n  },\n  \"frequency\": \"REAL_TIME\"\n}"
                },
                "url": "{{baseUrl}}/profile/notification-settings",
                "description": "Update notification preferences (JSONB in PostgreSQL)"
            }
        },
        {
            "name": "10. Get Privacy Settings",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Get privacy settings successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData).to.have.property(\"profileVisibility\");",
                            "});",
                            "",
                            "console.log(\"\u2705 Privacy settings retrieved\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/profile/privacy-settings",
                "description": "Get user's privacy preferences"
            }
        },
        {
            "name": "11. Update Privacy Settings",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Update privacy settings successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "});",
                            "",
                            "console.log(\"\u2705 Privacy settings updated\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "PUT",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"profileVisibility\": \"PUBLIC\",\n  \"showEmail\": false,\n  \"showPhone\": false,\n  \"showResume\": true,\n  \"allowMessagesFrom\": \"CONNECTIONS\",\n  \"searchable\": true,\n  \"showInRecommendations\": true,\n  \"allowJobRecommendations\": true,\n  \"dataSharing\": {\n    \"analytics\": true,\n    \"thirdParty\": false,\n    \"marketingPurposes\": false\n  }\n}"
                },
                "url": "{{baseUrl}}/profile/privacy-settings",
                "description": "Update privacy preferences (JSONB in PostgreSQL)"
            }
        },
        {
            "name": "12. Change Password",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Change password successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.status).to.eql(\"success\");",
                            "});",
                            "",
                            "// Update password variable for next login",
                            "pm.collectionVariables.set(\"password\", pm.collectionVariables.get(\"newPassword\"));",
                            "",
                            "console.log(\"\u2705 Password changed successfully\");",
                            "console.log(\"\ud83d\udd12 All sessions invalidated except current\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"currentPassword\": \"{{password}}\",\n  \"newPassword\": \"{{newPassword}}\",\n  \"confirmPassword\": \"{{newPassword}}\"\n}"
                },
                "url": "{{baseUrl}}/auth/change-password",
                "description": "Change user password (requires current password)"
            }
        },
        {
            "name": "13. Get Active Sessions",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Get sessions successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(Array.isArray(jsonData)).to.be.true;",
                            "    ",
                            "    if (jsonData.length > 0) {",
                            "        // Save first session ID for testing delete",
                            "        var nonCurrentSession = jsonData.find(s => !s.isCurrent);",
                            "        if (nonCurrentSession) {",
                            "            pm.collectionVariables.set(\"sessionId\", nonCurrentSession.sessionId);",
                            "        }",
                            "    }",
                            "});",
                            "",
                            "console.log(\"\u2705 Sessions list retrieved\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "GET",
                "header": [],
                "url": "{{baseUrl}}/auth/sessions",
                "description": "Get list of all active sessions with device info"
            }
        },
        {
            "name": "14. Enable 2FA (EMAIL)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Enable 2FA successful\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.data).to.have.property(\"twoFactorEnabled\");",
                            "    pm.expect(jsonData.data.twoFactorEnabled).to.be.true;",
                            "    ",
                            "    if (jsonData.data.backupCodes) {",
                            "        console.log(\"\ud83d\udd10 Backup codes: \" + jsonData.data.backupCodes.join(\", \"));",
                            "    }",
                            "});",
                            "",
                            "console.log(\"\u2705 2FA enabled\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"method\": \"EMAIL\"\n}"
                },
                "url": "{{baseUrl}}/auth/enable-2fa",
                "description": "Enable Two-Factor Authentication\n\nMethods: EMAIL, SMS, TOTP"
            }
        },
        {
            "name": "15. Disable 2FA",
            "event": [
                {
                    "listen": "prerequest",
                    "script": {
                        "exec": [
                            "// For testing, use any backup code or skip verification",
                            "console.log(\"\u26a0\ufe0f Disable 2FA requires:\");",
                            "console.log(\"- Current password\");",
                            "console.log(\"- 2FA code (from email/SMS) or backup code\");"
                        ],
                        "type": "text/javascript"
                    }
                },
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Disable 2FA response\", function () {",
                            "    // May fail if code is invalid - that's expected",
                            "    pm.expect(pm.response.code).to.be.oneOf([200, 400, 401]);",
                            "});",
                            "",
                            "if (pm.response.code === 200) {",
                            "    console.log(\"\u2705 2FA disabled\");",
                            "} else {",
                            "    console.log(\"\u26a0\ufe0f 2FA disable needs valid code - endpoint tested\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"password\": \"{{password}}\",\n  \"code\": \"123456\"\n}"
                },
                "url": "{{baseUrl}}/auth/disable-2fa",
                "description": "Disable 2FA (requires password + valid code)"
            }
        },
        {
            "name": "16. Forgot Password (Request OTP)",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Forgot password OTP sent\", function () {",
                            "    pm.response.to.have.status(200);",
                            "    var jsonData = pm.response.json();",
                            "    pm.expect(jsonData.status).to.eql(\"success\");",
                            "});",
                            "",
                            "console.log(\"\u2705 Password reset OTP sent to email\");",
                            "console.log(\"\ud83d\udce7 Check email or logs for OTP\");"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"email\": \"{{email}}\"\n}"
                },
                "url": "{{baseUrl}}/auth/forgot-password",
                "description": "Request password reset OTP (30 min validity)"
            }
        },
        {
            "name": "17. Delete Avatar",
            "event": [
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "pm.test(\"Delete avatar response\", function () {",
                            "    // May return 404 if no avatar",
                            "    pm.expect(pm.response.code).to.be.oneOf([200, 404]);",
                            "});",
                            "",
                            "if (pm.response.code === 200) {",
                            "    console.log(\"\u2705 Avatar deleted from Cloudinary\");",
                            "    pm.collectionVariables.set(\"avatarUrl\", \"\");",
                            "} else {",
                            "    console.log(\"\u26a0\ufe0f No avatar to delete (expected if upload skipped)\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "DELETE",
                "header": [],
                "url": "{{baseUrl}}/profile/avatar",
                "description": "Delete avatar from Cloudinary and database"
            }
        },
        {
            "name": "18. OPTIONAL - Deactivate Account",
            "event": [
                {
                    "listen": "prerequest",
                    "script": {
                        "exec": [
                            "console.log(\"\u26a0\ufe0f OPTIONAL: Deactivate account\");",
                            "console.log(\"This will disable the account temporarily\");",
                            "console.log(\"Skip this if you want to keep testing\");"
                        ],
                        "type": "text/javascript"
                    }
                },
                {
                    "listen": "test",
                    "script": {
                        "exec": [
                            "// This is optional - may want to skip for continuous testing",
                            "pm.test(\"Deactivate account (optional)\", function () {",
                            "    pm.expect(pm.response.code).to.be.oneOf([200, 400]);",
                            "});",
                            "",
                            "if (pm.response.code === 200) {",
                            "    console.log(\"\u2705 Account deactivated (30-day retention)\");",
                            "} else {",
                            "    console.log(\"\u26a0\ufe0f Deactivation skipped or failed\");",
                            "}"
                        ],
                        "type": "text/javascript"
                    }
                }
            ],
            "protocolProfileBehavior": {
                "disableBodyPruning": true
            },
            "request": {
                "auth": {
                    "type": "bearer",
                    "bearer": [
                        {
                            "key": "token",
                            "value": "{{accessToken}}",
                            "type": "string"
                        }
                    ]
                },
                "method": "POST",
                "header": [
                    {
                        "key": "Content-Type",
                        "value": "application/json"
                    }
                ],
                "body": {
                    "mode": "raw",
                    "raw": "{\n  \"reason\": \"TAKING_A_BREAK\",\n  \"feedback\": \"Testing deactivation feature\",\n  \"password\": \"{{password}}\"\n}"
                },
                "url": "{{baseUrl}}/profile/deactivate",
                "description": "\u26a0\ufe0f OPTIONAL: Deactivate account temporarily\n\n**Note:** Uncomment/enable this only for full workflow testing"
            }
        }
    ],
    "event": [
        {
            "listen": "prerequest",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// Global pre-request script",
                    "console.log(\"\ud83d\ude80 WorkFitAI Profile Management Tests\");",
                    "console.log(\"\ud83d\udccd API Gateway: \" + pm.collectionVariables.get(\"baseUrl\"));"
                ]
            }
        },
        {
            "listen": "test",
            "script": {
                "type": "text/javascript",
                "exec": [
                    "// Global test script",
                    "pm.test(\"Response time is acceptable\", function () {",
                    "    pm.expect(pm.response.responseTime).to.be.below(5000);",
                    "});"
                ]
            }
        }
    ]
}