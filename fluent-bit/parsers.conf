# ==============================================================================
# Docker JSON log parser (standard format)
# ==============================================================================
[PARSER]
    Name        docker
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

# ==============================================================================
# Docker JSON log parser with attrs (for logs with container tags)
# Docker log format: {"log": "...", "stream": "...", "attrs": {"tag": "container/service"}, "time": "..."}
# ==============================================================================
[PARSER]
    Name        docker_with_attrs
    Format      json
    Time_Key    time
    Time_Format %Y-%m-%dT%H:%M:%S.%L
    Time_Keep   On

# ==============================================================================
# Parser for Spring Boot JSON logs (logstash-logback-encoder format)
# Fields: @timestamp, level, logger_name, thread_name, message, service, etc.
# ==============================================================================
[PARSER]
    Name        spring_json
    Format      json
    Time_Key    @timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

# ==============================================================================
# Parser for plain text Spring Boot logs (fallback)
# Format: 2024-12-06 12:00:00.123 INFO 1 --- [main] c.example.App : Message
# ==============================================================================
[PARSER]
    Name        spring_text
    Format      regex
    Regex       ^(?<timestamp>\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2}\.\d{3})\s+(?<level>\w+)\s+(?<pid>\d+)\s+---\s+\[(?<thread>[^\]]+)\]\s+(?<logger>[^\s]+)\s+:\s+(?<message>.*)$
    Time_Key    timestamp
    Time_Format %Y-%m-%d %H:%M:%S.%L
    Time_Keep   On

# ==============================================================================
# Logstash encoder format parser (alternative)
# ==============================================================================
[PARSER]
    Name        logstash
    Format      json
    Time_Key    @timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep   On

# ==============================================================================
# Syslog parser (for system logs if needed)
# ==============================================================================
[PARSER]
    Name        syslog
    Format      regex
    Regex       ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.*)$
    Time_Key    time
    Time_Format %b %d %H:%M:%S
